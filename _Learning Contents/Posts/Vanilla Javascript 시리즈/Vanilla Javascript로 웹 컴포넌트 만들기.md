## 2. state - setState - render  

#### ðŸ“Œ í•µì‹¬

1. stateê°€ ë³€ê²½ë˜ë©´ `render`ë¥¼ ì‹¤í–‰í•œë‹¤.
2. stateëŠ” `setState`ë¡œë§Œ ë³€ê²½í•´ì•¼ í•œë‹¤.

### (1) ê¸°ëŠ¥ êµ¬í˜„: `setState` í•¨ìˆ˜
  
1. ì¸ìžë¡œ ë°›ì€ newStateë¡œ stateë¥¼ ë°”ê¿”ì¤€ë‹¤.
2. stateê°€ ë³€ê²½ëœ í›„ ìƒˆë¡­ê²Œ ì„¤ì •ëœ stateë¡œ ë‹¤ì‹œ ë Œë”ë§í•œë‹¤.

  
- ì˜ë„: ë°ì´í„°ì˜ ìƒíƒœë¥¼ (ì—„ê²©í•˜ê²Œ!) ê´€ë¦¬í•˜ê¸° ìœ„í•´ ì´ í•¨ìˆ˜ì—ë§Œ ê·¸ ì—­í• ê³¼ ì±…ìž„ì„ ì¤€ë‹¤. (ì—¬ê¸°ì €ê¸°ì„œ ìƒíƒœë¥¼ ë³€ê²½í•˜ë©´ ê´€ë¦¬ê°€ ì–´ë µê¸° ë•Œë¬¸ì—)
- ìƒíƒœ(State)ì˜ ë³€í™”ì— ë”°ë¼ DOMì„ ë Œë”ë§í•œë‹¤.

### ì§ˆë¬¸

- ì¸ìžë¡œ ë°›ì€ newStateë¡œ stateë¥¼ ìž¬í• ë‹¹í•´ì¤„ ë•Œ ì™œ `...state`ë„ í•´ì£¼ëŠ” ì´ìœ ?
- `...newState`ë§Œ í•´ì¤˜ë„ ë˜ëŠ” ìƒí™©
- ì§€ê¸ˆì€ stateì— items í”„ë¡œí¼í‹°ë°–ì— ì—†ì§€ë§Œ, ìƒíƒœë¥¼ ê´€ë¦¬í•´ì£¼ë ¤ëŠ” ë˜ ë‹¤ë¥¸ í”„ë¡œí¼í‹°ê¹Œì§€ í¬í•¨í•´ì„œ ë‹¤ ê´€ë¦¬í•˜ê¸° ìœ„í•´ì„œ? (ì˜ˆì‹œë¡œ í™•ì¸í•˜ê¸°)
- ì¶”ê°€ëœ item5ë§Œ ë¶™ì—¬ì£¼ëŠ”ê²Œ ì•„ë‹ˆë¼ item1 ~ item4ê¹Œì§€ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë§Œë“¤ì–´ì§„ë‹¤.
- ì´ì „ stateì™€ ë¹„êµí•´ì„œ ë‹¬ë¼ì§„ ë¶€ë¶„ë§Œ ë Œë”ë§í•˜ë ¤ë©´? (ìµœì í™” -> virtualDOM, diff ì•Œê³ ë¦¬ì¦˜)

### (3) ëª¨ë“ˆí™”

```js
import Items from './components/Items.js';

class App {
  constructor() {
    const $app = document.querySelector('#app');
    new Items($app);
  }
}

new App();
```

- ì§ˆë¬¸: parent elementë¥¼ ì¸ìžë¡œ ë„˜ê¸°ëŠ” ë°©ì‹ vs child elementsë¥¼ parent elementì— appendí•˜ëŠ” ë°©ì‹
- í˜„ìž¬ ì§„í–‰ì¤‘ì¸ ì•„ë§ˆì¡´ í”„ë¡œì íŠ¸ëŠ” í›„ìž ë°©ì‹: getterë¡œ nodeë¥¼ parentì— appendí•´ì¤€ë‹¤.
- ì´ ê²½ìš°ì— nodeë¥¼ ë°”ê¿€ ìˆ˜ëŠ” ì—†ì§€ë§Œ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ í´ëž˜ìŠ¤ ë‚´ë¶€ê°€ ì•„ë‹Œ ê³³ì—ì„œë„ nodeì˜ í•˜ìœ„ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆëŠ” êµ¬ì¡°ë¼ ì „ìžê°€ ë” ì í•©í•˜ë‹¤ëŠ” ê¹¨ë‹¬ìŒì„ ì–»ìŒ
- êµ³ì´ ì™œ ìžì‹ì´ ë¶€ëª¨ë¥¼ ë°›ì•„ì•¼ í•˜ëŠ”ì§€, ì™œ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì˜ ìƒíƒœ/ë©”ì„œë“œë¥¼ ì „ë‹¬ ë°›ì•„ì•¼ í•˜ëŠ”ì§€ ì˜ë¬¸ì´ ìžˆì—ˆìŒ(ê°ê° ê°œë³„ì ìœ¼ë¡œ êµ¬í˜„í•´ì„œ ë¶™ì—¬ì£¼ë©´ ë˜ëŠ”ê±° ì•„ë‹Œê°€ í•˜ëŠ” ìƒê°)
- ì•„ì§ ìƒíƒœ ê´€ë¦¬ì— ì–´ë ¤ì›€ì„ ê²ªì€ ê²½í—˜ì´ ì—†ì–´ì„œ ë¬¸ì œ ì˜ì‹ì— ê³µê°í•˜ì§€ ëª»í•œ ë“¯í•˜ë‹¤.
- ðŸ” ë‰´ìŠ¤ ìŠ¤íƒ ë“œ ë¯¸ì…˜ êµ¬í˜„ ì¤‘ì¸ ì½”ìŠ¤ ë¶„ë“¤ì˜ ê²½í—˜ë‹´ì„ ë“£ê³  ê°„ì ‘ ê³µê°~~~

## 3. ì´ë²¤íŠ¸ ì²˜ë¦¬í•˜ê¸°

### Before

- stateê°€ ë³€í•˜ë©´ render ì‹¤í–‰
- render ì•ˆì—ì„œ setEventë¥¼ ì‹¤í–‰
- stateê°€ ë³€í•  ë•Œë§ˆë‹¤ render & ì´ë²¤íŠ¸ê°€ ìƒˆë¡œ ë“±ë¡

### After

- eventë¥¼ ê°ê°ì˜ í•˜ìœ„ ìš”ì†Œê°€ ì•„ë‹ˆë¼ componentì˜ target ìžì²´(parent)ì— ë“±ë¡
- ì´ë²¤íŠ¸ ë²„ë¸”ë§ íŠ¹ì„±ì„ ì´ìš©í•˜ì—¬ íƒ€ê²Ÿì— ì´ë²¤íŠ¸ ìœ„ìž„í•˜ì—¬ componentê°€ ìƒì„±ë˜ëŠ” ì‹œì ì— ì´ë²¤íŠ¸ ë“±ë¡ì„ í•œë‹¤.
- ì¼ì¼ì´ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•  í•„ìš”ì—†ê³ , ì´í›„ì— í•˜ìœ„ ìš”ì†Œê°€ ì¶”ê°€ë˜ë”ë¼ë„ ë³„ë„ë¡œ ì´ë²¤íŠ¸ ë“±ë¡í•  í•„ìš” ì—†ìŒ

### ì´ë¥¼ ì¶”ìƒí™”í•œ addEvent í•¨ìˆ˜

- ì¶”ìƒí™”ëŠ” ìž˜í•˜ë©´ ì–¸ì œë‚˜ ì˜³ë‹¤

```js
addEvent (eventType, selector, callback) {
    const children = [ ...this.$target.querySelectorAll(selector) ];
    this.$target.addEventListener(eventType, event => {
      if (!event.target.closest(selector)) return false;
      callback(event);
    })
  }
```

- ì§ˆë¬¸: selectorì— í•´ë‹¹í•˜ëŠ” ëª¨ë“  ìš”ì†Œë¥¼ ë‹´ì€ childrenì€ ì™œ ìžˆëŠ”ì§€?
- ðŸ” ì“¸ëª¨ ì—†ìŒì„ ë³´ì—¬ì£¼ê¸° ìœ„í•¨ ì¦‰, ê° ìžì‹ ìš”ì†Œì— ì¼ì¼ì´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ë“±ë¡í•´ì¤„ í•„ìš” ì—†ë‹¤!

```js
setEvent () {
    this.addEvent('click', '.addBtn', ({ target }) => {
      const { items } = this.state;
      this.setState({ items: [ ...items, `item${items.length + 1}` ] });
    });
    this.addEvent('click', '.deleteBtn', ({ target }) => {
      const items = [ ...this.state.items ];
      items.splice(target.dataset.index, 1);
      this.setState({ items });
    });
  }
```

1. eventType: `click`, selector: `.addBtn`
- `addBtn` í´ë¦­ ì‹œ items ìƒíƒœ ë³€ê²½

2. eventType: `click`, selector: `.deleteBtn`
- `deleteBtn` í´ë¦­ ì‹œ target elementì˜ data-indexì— í•´ë‹¹í•˜ëŠ” itemì„ ì‚­ì œí•˜ê³  ìƒíƒœ ìˆ˜ì •
- ì§ì ‘ stateë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  ê°ì²´ë¥¼ ë³µì‚¬í•˜ì—¬ ê°€ê³µ í›„ **setState í•¨ìˆ˜**ì˜ ì¸ìžë¡œ ì „ë‹¬í•˜ì—¬ ìƒíƒœë¥¼ ë³€ê²½í•´ì¤€ë‹¤. (í•¨ìˆ˜í˜• í”„ë¡œê·¸ëž˜ë°)
  - ðŸ” **ê°ì²´ì˜ ë¶ˆë³€ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œ**: ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ ì´ì „ ê°ì²´ì™€ì˜ ë¹„êµí•˜ê¸° ìœ„í•´ì„œ! (ì´í›„ì—ëŠ” ë³€í™”ëœ ë¶€ë¶„ë§Œ ë Œë”ë§)

## 4. ì»´í¬ë„ŒíŠ¸ ë¶„í• í•˜ê¸°

```
â”œâ”€â”€ index.html
â””â”€â”€ src
    â”œâ”€â”€ App.js               # mainì—ì„œ App ì»´í¬ë„ŒíŠ¸ë¥¼ ë§ˆìš´íŠ¸í•œë‹¤.
    â”œâ”€â”€ main.js              # jsì˜ entry í¬ì¸íŠ¸
    â”œâ”€â”€ components
    â”‚   â”œâ”€â”€ ItemAppender.js
    â”‚   â”œâ”€â”€ ItemFilter.js
    â”‚   â””â”€â”€ Items.js
    â””â”€â”€ core
        â””â”€â”€ Component.js
```

### ì»´í¬ë„ŒíŠ¸ë¥¼ ê¸°ëŠ¥ ë‹¨ìœ„ë¡œ êµ¬ì„±í•˜ê¸°

- ëª©ì : **í•˜ë‚˜ì˜ ì»´í¬ë„ŒíŠ¸ê°€ ìµœëŒ€í•œ ìž‘ì€ ë‹¨ìœ„ì˜ ì¼ì„ í•˜ë„ë¡ í•œë‹¤.**
- ê¸°ì¤€: ìž¬í™œìš©í•  ìˆ˜ ìžˆë„ë¡, **ìž¬ì‚¬ìš©ì„±**ì„ ë†’ì´ê¸°

1. entry pointê°€ app.jsì—ì„œ main.jsê°€ ë˜ì—ˆë‹¤
2. App Componentë¥¼ ì¶”ê°€

   - ê¸°ì¡´ì˜ Itemsì— ì¡´ìž¬í•˜ë˜ ë¡œì§ -> App.js

3. Itemsì—ì„œ ItemAppender, ItemFilter ë“±ì„ ë¶„ë¦¬

   - Items, ItemAppender, ItemFilter ë“±ì€ App.jsì—ì„œ ë„˜ê²¨ì£¼ëŠ” ë¡œì§ì„ ì‚¬ìš©í•˜ë„ë¡ ë§Œë“ ë‹¤.
   - ì§ˆë¬¸: ì™œ ìžì‹ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë©”ì„œë“œë¥¼ ì •ì˜í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ ë¶€ëª¨ì—ì„œ ë¡œì§ì„ ì§œê³  ìžì‹í•œí…Œ ì´ ë©”ì„œë“œë¥¼ ë„˜ê¸¸ê¹Œ?
   - **ìƒíƒœë¥¼ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸(root)ì—ì„œë§Œ ì ‘ê·¼í•˜ê³  ë³€ê²½í•˜ê³  ê´€ë¦¬í•œë‹¤.**
   - Elementì˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡ì€ ê° í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ í•˜ì§€ë§Œ, ì´ë²¤íŠ¸ì— ë”°ë¥¸ ë³€ê²½ë˜ëŠ” ìƒíƒœëŠ” appì—ì„œ ê´€ë¦¬ëœë‹¤.

### propsì™€ mountedì˜ ì—­í• 

- props: ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ìžì‹ ì»´í¬ë„ŒíŠ¸ì—ê²Œ ìƒíƒœ í˜¹ì€ ë©”ì†Œë“œë¥¼ ë„˜ê²¨ì¤€ë‹¤.
- mounted: render ì´í›„ì— ì¶”ê°€ì ì¸ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜
- ì§ˆë¬¸: 'ë§ˆìš´íŠ¸í•œë‹¤', 'ìžì‹ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§ˆìš´íŠ¸ í•œë‹¤'ëŠ” í‘œí˜„ì˜ ì˜ë¯¸? ì™œ ì´ê±¸ mountë¼ê³  í• ê¹Œ?
- ì¶”ì¸¡: ìžì‹ ì»´í¬ë„ŒíŠ¸ HTML elementë¥¼ í´ëž˜ìŠ¤ ì¸ìžë¡œ ì „ë‹¬í•˜ëŠ” ê²ƒì€ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ ìž…ìž¥ì—ì„œëŠ” ì§‘ì–´ë„£ëŠ”ë‹¤ê³  ë³¼ ìˆ˜ ìžˆë‹¤.
- ðŸ” vue, react ë“± ë¼ì´ë¸ŒëŸ¬ë¦¬ë§ˆë‹¤ mountì˜ ì—­í• ì´ ë‹¤ì–‘í•˜ë‹¤.
  - ë°ì´í„°ë¥¼ ë°›ì•„ì•¼ í•˜ëŠ” ê²½ìš° ë¹„ë™ê¸° ë¡œì§ì„ ìˆ˜í–‰í•˜ëŠ” ë“± ë³µìž¡í•´ì§€ë©´ ë³„ë„ ë©”ì„œë“œë¡œ ë¶„ë¦¬í•œë‹¤.
  - ë‹¨ìˆœížˆ ìžì‹ ì„ ë Œë”ë§í•œ ì´í›„ì— ìžì‹ ì»´í¬ë„ŒíŠ¸ë“¤ì„ ë Œë”ë§í•˜ê³  ì´ë²¤íŠ¸ë¥¼ ì„¤ì •í•´ì£¼ëŠ” í›„ì† ìž‘ì—…ë§Œ í•˜ëŠ” ê²Œ ì•„ë‹ˆë‹¤!
  - [den branch ë‚´ìš© ì°¸ê³ ](https://github.com/codesquad-fe-book-study/web-component-js/blob/den/vanilla-js-web-component.md)

```md
ë§ˆìš´íŠ¸ Mount

1. ìš´ì˜ì²´ì œì—ì„œ íŒŒì¼ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•  ìˆ˜ ìžˆë„ë¡ í•˜ëŠ” ê³¼ì •
2. ì‚¬ìš©ìžê°€ ì»´í“¨í„°ì— ë””ìŠ¤í¬ë¥¼ ì§‘ì–´ë„£ëŠ” ê²ƒ
3. ì»´í“¨í„° ê³¼í•™ì—ì„œ ì €ìž¥ ìž¥ì¹˜ì— ì ‘ê·¼í•  ìˆ˜ ìžˆëŠ” ê²½ë¡œë¥¼ ë””ë ‰í„°ë¦¬ êµ¬ì¡°ì— íŽ¸ìž…ì‹œí‚¤ëŠ” ìž‘ì—…
```

- ê° ì»´í¬ë„ŒíŠ¸ elementë¥¼ ë§Œë“¤ê³ , ìžì‹ ì»´í¬ë„ŒíŠ¸ í´ëž˜ìŠ¤ì— ì²«ë²ˆì§¸ ì¸ìžë¡œ ë„˜ê²¨ì¤€ë‹¤. ê° ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ì •ì˜í•´ë‘” templateì´ í•´ë‹¹ elementì— ì¶”ê°€ëœë‹¤.
- ë‘ë²ˆì§¸ ì¸ìžë¡œ ìžì‹ ì»´í¬ë„ŒíŠ¸ì—ì„œ ìˆ˜í–‰í•  ë™ìž‘ì„ ì „ë‹¬í•œë‹¤. (ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì˜ ë©”ì„œë“œë¥¼ ì „ë‹¬í•œë‹¤.)
- ì§ˆë¬¸: ì™œ superê°€ ì—†ì§€? ê·¸ëƒ¥ ìƒëžµí•œê±´ê°€ ì†ŒìŠ¤ ì½”ë“œì—ëŠ” ìžˆëŠ”ì§€ í™•ì¸í•˜ê¸°
- ì§ˆë¬¸: mounted í•¨ìˆ˜ ì‹¤í–‰ ì‹œì ì´ ì™œ render ì•ˆì— ìžˆì–´ì•¼ í• ê¹Œ?

### ë™ìž‘ ì›ë¦¬ ë° ë°©ì‹ ì´í•´í•˜ê¸°

> ì°¸ê³ : https://github.com/JunilHwang/simple-component

#### ðŸ“Œ core Component êµ¬ì¡°

1. Component

- props: `$target`, `props`, `state`
- method: `initState`, `setEvent`, `render`, `getTemplate`
- ë™ìž‘ ë°©ì‹
  - ì»´í¬ë„ŒíŠ¸ëŠ” ìƒì„± ì‹œ ì²«ë²ˆì§¸ ì¸ìžë¡œ `$target: htmlElement`, ë‘ë²ˆì§¸ ì¸ìžë¡œ `props: {}`ë¥¼ ë°›ëŠ”ë‹¤.
    - `$target`: ê° ì»´í¬ë„ŒíŠ¸ì˜ this.$targetì€ ìƒì„± ì‹œ ì²«ë²ˆì§¸ ì¸ìžë¡œ ë°›ì€ ìžì‹ ì˜ íƒœê·¸ë¥¼ ì˜ë¯¸
    - `$props`: ìƒì„± ì‹œ ë‘ë²ˆì§¸ ì¸ìžë¡œ ë°›ì€ ë¶€ëª¨ì˜ props ì¼ë¶€ (ìžì‹ ì´ ìˆ˜í–‰í•  ë©”ì„œë“œë‚˜ í•„ìš”í•œ ìƒíƒœë¥¼ ë¶€ëª¨ë¡œë¶€í„° ì „ë‹¬ ë°›ì€ ê²ƒ)
    - `getTemplate`: ì§ê³„(?) ìžì‹ ìš”ì†Œë¡œë§Œ ì´ë£¨ì–´ì§„ í…œí”Œë¦¿ ë¦¬í„°ëŸ´
    - ìžì‹ ì»´í¬ë„ŒíŠ¸ì˜ ìžì„¸í•œ êµ¬ì„±ì€ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì˜ `getTemplate`ì—ì„œ ì •ì˜ëœë‹¤.
    - component data ì†ì„±ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ íƒ€ìž… ì„¤ì •

1. ê³µí†µ

- `getTemplate`, `setEvent`
- `getTemplate`: propsë¡œ ì „ë‹¬ë°›ì€ ë¶€ëª¨ ìƒíƒœì— ë”°ë¥¸(ìƒíƒœì— ë§žëŠ”) templateì„ ë§Œë“ ë‹¤.
- `setEvent`: propsë¡œ ì „ë‹¬ë°›ì€ ë¶€ëª¨ì˜ ë©”ì„œë“œë¥¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í•¨ìˆ˜ì—ì„œ ì‹¤í–‰í•˜ê²Œ ëœë‹¤.

1. App (ìƒìœ„ ì»´í¬ë„ŒíŠ¸)

- `initState`: ì „ì²´ ì´ˆê¸° ìƒíƒœ ë°ì´í„° init
- `mounted`: ìžì‹ ì»´í¬ë„ŒíŠ¸ì— ê° ì»´í¬ë„ŒíŠ¸ì˜ ê¸°ëŠ¥ì— ë”°ë¼ nodeì™€ props(method)ë¥¼ ì „ë‹¬í•œë‹¤.(ë§ˆìš´íŠ¸)
- `filteredItems`, `addItem`, `deleteItem`, `toggleItem`, `filterItem`

1. ItemAppender
1. Items
1. ItemFilter

```js
class Component {
  $target;
  $props;
  $state;

  constructor($target, $props) {
    this.$target = $target;
    this.$props = $props;
    this.setup();
    this.setEvent();
    this.render();
  }
  setup() {}
  mounted() {}
  template() {
    return '';
  }
  render() {
    this.$target.innerHTML = this.template();
    this.mounted();
  }
  setEvent() {}
  setState(newState) {
    this.$state = { ...this.$state, ...newState };
    this.render();
  }
  addEvent(eventType, selector, callback) {
    this.$target.addEventListener(eventType, (event) => {
      if (!event.target.closest(selector)) return false;
      callback(event);
    });
  }
}
```